## 5. まとめて学ぶと良いテーマ

### 5-1. LIFFとMessaging APIの役割分担

* **LIFF:** ユーザーのUI・認証を担う（`liff.getIDToken()`でIDトークン取得）。
* **Messaging API:** Botからグループに通知、プロフィール取得などを行う（例: `get_group_member_profile` でアイコンと名前取得）。

  → 両者を組み合わせることで「ユーザー操作（LIFF）→グループへの共有（Messaging）」という体験が実現できる。

---

### 5-2. セキュリティモデル

* **IDトークン検証:** すべての更新系APIで必須。
* **スコープ管理:** `scope_id` を正しく付与して情報漏洩を防ぐ。
* **権限制御:** `policies.py` の `can_edit_event` により「作成者だけが編集可能」となっている。

```python
def can_edit_event(user_id: str, event) -> bool:
    return getattr(event, "created_by", None) == user_id
```

---

### 5-3. UX改善の工夫

* 保存や失敗時のフィードバックは自然なLINE口調に統一している。
  * 「保存したよ」
  * 「不正なIDだよ」
  * 「読み込みに失敗したよ」
* これにより「社内Webアプリ」的な無機質さではなく、LINEらしい親しみやすい体験になる。

---

### 5-4. 学ぶと良い順序

1. **LIFFの仕組み** （初期化、IDトークン取得、スコープID）
2. **API呼び出しフロー** （イベント作成→検証→保存→通知）
3. **UI連携** （モーダル、参加ボタン、参加者一覧）
4. **セキュリティ強化** （IDトークン検証、scope管理、権限制御）

この流れで学習すると、LINE連携アプリ開発の全体像がつかみやすい。

---
